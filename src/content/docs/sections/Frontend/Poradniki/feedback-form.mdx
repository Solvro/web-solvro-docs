---
title: Przyjemny formularz feedback
sidebar:
  order: 7
description: Jak utworzy formularz feedbacku, kt贸ry bdzie przyjemny dla u偶ytkownika i szybki w wykonaniu dla ciebie bez koniecznoci tworzenia panelu administracyjnego u siebie.
---

import { Steps } from "@astrojs/starlight/components";
import ImageFeedback1 from "#assets/tutorials/feedback-1.png";
import ImageFeedback2 from "#assets/tutorials/feedback-2.png";
import ImageFeedback3 from "#assets/tutorials/feedback-3.png";
import ImageFeedback4 from "#assets/tutorials/feedback-4.png";
import ImageFeedback5 from "#assets/tutorials/feedback-5.png";
import ImageFeedback6 from "#assets/tutorials/feedback-6.png";
import ImageFeedback7 from "#assets/tutorials/feedback-7.png";

Elo 偶elo! Czy zastanawiae si kiedy, jak zrobi formularz feedbacku, kt贸ry bdzie przyjemny dla u偶ytkownika, a jednoczenie szybki w wykonaniu dla ciebie, bez koniecznoci tworzenia panelu administracyjnego u siebie? W tym poradniku dowiesz si, jak to osign z wykorzystaniem Twojego ulubionego frameworku Next.js (lub dowolnego innego, nawet zwykego HTML-a) oraz backendu w postaci Formularzy Google.

Zamys jest taki, aby stworzy w peni wasny formularz na swojej stronie, a odpowiedzi przeglda wygodnie na stronie Formularzy Google lub w Arkuszach Google. Dziki temu zaoszczdzisz czas na tworzeniu infrastruktury, jednoczenie zachowujc pen kontrol nad wygldem i dziaaniem formularza.

## Zao偶enia

Technologie u偶yte:

1. NextJS jako przykad frameworku na frontcie
2. Google Forms jako backend z odpowiedziami
3. shadcn/ui jako biblioteka komponent贸w

## tl;dr

Wszystko sprowadza si do wysania formularza POST do Google Forms z odpowiednimi danymi:

```html
<form action="https://docs.google.com/forms/.../formResponse" method="POST">
  <input type="text" name="entry.123456789" />
  <input type="text" name="entry.987654321" />
  <button type="submit">Submit</button>
</form>
```

Aczkolwiek zrobimy to w bardziej elegancki spos贸b z u偶yciem `react-hook-form` i `shadcn/ui` oraz zabezpieczeniem, przeciwko spamowaniu.

## Let's gooo 

To s szybkie kroki, dziki kt贸rym stworzysz formularz feedbacku:

<Steps>

1. **Stw贸rz nowy formularz:**

   Przejd藕 na stron [Google Forms](https://docs.google.com/forms/u/0/), stw贸rz nowy formularz i dodaj swoje pytania.

   <img src={ImageFeedback1} width={"100%"} height={"auto"} />

2. **Opublikuj formularz i stw贸rz arkusz**

   Nastpnie opublikuj publicznie sw贸j forms:

   - Przycisk "Opublikuj"
   - W kategorii respondenci kliknij "Zarzdzaj"
   - 'Dostp og贸lny -> Widok respondenta' zmie z "Politechnika Wrocawska" na "Ka偶da osoba majca link"
   - "Gotowe" -> "Opublikuj"

   <img src={ImageFeedback2} width={"100%"} height={"auto"} />

3. **Stw贸rz poczony arkusz google**

   Mo偶esz przeglda r贸wnie偶 odpowiedzi i atwo je udostpnia dziki arkuszom Google. Wystarczy, 偶e po przejciu do zakadki odpowiedzi, <br/>klikniesz zielony przycisk "Link do Arkuszy" -> "Utw贸rz":

   <img src={ImageFeedback3} width={"100%"} height={"auto"} />

   :::tip
   Arkusz ten bdzie automatycznie aktualizowany o nowe odpowiedzi oraz zmiany w formularzu, wic nie musisz si o to martwi. Mo偶esz go wygodnie udostpnia innym osobom.
   :::

4. **Nowy komponent na stronie**

   Naszed czas na dodanie formularza do swojej strony. Przejd藕my do Twojego projektu NextJS, stw贸rzmy nowy client komponent `FeedbackForm.tsx`:

   ```tsx
   // FeedbackForm.tsx
   "use client";

   import React from "react";

   export function FeedbackForm() {
     return <div>Witam</div>;
   }
   ```

5. **Wymagane dependencies**

   Do obsugi `<form>` u偶yjmy `react-hook-form` i komponentu shadcn/ui `Form`.
   Najpierw dodaj ten komponent do projektu:

   ```bash
   npx shadcn@latest add form
   ```

6. **Schemat**

   Aby upewni si, 偶e u偶ytkownik wysya tylko takie dane, kt贸re s wymagane, stw贸rzmy schemat formularza:

   ```tsx
   // schemas.ts
   import { z } from "zod";

   export const FeedbackFormSchema = z.object({
     email: z.string(),
     content: z.string(),
   });
   ```

7. **Formularz**

   Nastpnie dodajmy formularz do naszego komponentu:

   ```tsx
   // FeedbackForm.tsx
   "use client";

   import { zodResolver } from "@hookform/resolvers/zod";
   import React from "react";
   import { useForm } from "react-hook-form";
   import type { z } from "zod";

   import { Button } from "@/components/ui/button";
   import {
     Form,
     FormControl,
     FormField,
     FormItem,
     FormLabel,
     FormMessage,
   } from "@/components/ui/form";
   import { Input } from "@/components/ui/input";
   import { Textarea } from "@/components/ui/textarea";
   import { FeedbackFormSchema } from "@/types/schemas";

   export function FeedbackForm() {
     const form = useForm<z.infer<typeof FeedbackFormSchema>>({
       resolver: zodResolver(FeedbackFormSchema),
       defaultValues: {
         email: "",
         content: "",
       },
     });

     async function onSubmit(values: z.infer<typeof FeedbackFormSchema>) {
       // Do something with the form values
     }
     return (
       <div className="m-10 w-full rounded-md border p-5 sm:max-w-[425px]">
         <h1 className="text-lg font-semibold">Formularz</h1>
         <Form {...form}>
           <form
             onSubmit={form.handleSubmit(onSubmit)}
             className="grid w-full gap-4 py-4 sm:max-w-[425px]"
           >
             <FormField
               control={form.control}
               name="email"
               render={({ field }) => (
                 <FormItem>
                   <FormLabel>Adres email</FormLabel>
                   <FormControl>
                     <Input
                       placeholder="123456@student.pwr.edu.pl"
                       {...field}
                     />
                   </FormControl>
                   <FormMessage />
                 </FormItem>
               )}
             />
             <FormField
               control={form.control}
               name="content"
               render={({ field }) => (
                 <FormItem>
                   <FormLabel>Tre</FormLabel>
                   <FormControl>
                     <Textarea placeholder="Tre zgoszenia" {...field} />
                   </FormControl>
                   <FormMessage />
                 </FormItem>
               )}
             />
             <Button type="submit">Przelij zgoszenie</Button>
           </form>
         </Form>
       </div>
     );
   }
   ```

   :::tip
   Jest to podstawowa metoda tworzenia formularzy z `shadcn/ui` i `react-hook-form`. Jeli nie rozumiesz tego kodu, zachcam do odwiedzenia [dokumentacji shadcn/ui](https://ui.shadcn.com/docs/components/form).
   :::

   Efekt tego wyglda mniej wicej tak:

   {" "}

   <img src={ImageFeedback4} width={"100%"} height={"auto"} />

8. **Backend**

   Aby caa magia moga si zadzia, stw贸rzmy `Server Action`, kt贸ra bdzie wysya dane do Google.

   ```tsx
   // actions/feedback.ts
   "use server";

   import type { z } from "zod";

   import { env } from "@/env.mjs";
   import { FeedbackFormSchema } from "@/types/schemas";

   export const sendFeedbackForm = async (
     values: z.infer<typeof FeedbackFormSchema>
   ) => {
     try {
       FeedbackFormSchema.parse(values);

       // Jaka funkcja do sprawdzania rate-limit贸w, czy u偶ytkownik nie spamuje
       // const isSpam = await checkSpam(values);
       // if (isSpam) { return false } czy co

       const googleFormUrl = process.env.FORMS_LINK;

       const formData = new URLSearchParams();
       formData.append(process.env.FORMS_email, values.email);
       formData.append(process.env.FORMS_content, values.content);

       const response = await fetch(googleFormUrl, {
         method: "POST",
         body: formData,
         headers: {
           "Content-Type": "application/x-www-form-urlencoded",
         },
       });

       // Obsuga odpowiedzi
       if (response.ok) {
         return true;
       } else {
         console.error("Error while sending feedback form", response);
       }
     } catch (error) {
       console.error("Error while sending feedback form", error);
     }
   };
   ```

9. **Zdobycie potrzebnych danych**

   Aby uzupeni .env o potrzebne dane, przejd藕 do swojego formularza Google i w g贸rnym topbarze po prawej kliknij ikonke oka, czyli podgld:

   <img src={ImageFeedback5} width={"100%"} height={"auto"} />

   Nastpnie otw贸rz narzdzia deweloperskie przegldarki i wybierz zakadk `Elements`. Nastpnie inspect toolem (`Ctrl + Shift + C`) najed藕 na formularz i znajd藕 element `form`:

   <img src={ImageFeedback6} width={"100%"} height={"auto"} />

   Skopiuj link z `action` i zapisz do zmiennej `FORMS_LINK` w env.

   Nastpnie wyszukaj `Ctrl + F` w devtoolsach (nie na stronie!) `entry.` aby znale藕 dwa pola (jeli tyle miae w formularzu) i skopiuj je do odpowiednich zmiennych. S one uo偶one zwykle w dobrej kolejnoci:

   <img src={ImageFeedback7} width={"100%"} height={"auto"} />

   Przykadowy `.env`:

   ```
    // .env
    FORMS_LINK=https://docs.google.com/forms/.../formResponse
    FORMS_email=entry.123456789
    FORMS_content=entry.987654321
   ```

10. **Poczenie formularza z backendem**

    Na sam koniec zostao poczenie formularza z backendem. Wystarczy doda `Server Action` do naszego formularza:

    ```tsx {20, 32}
    // FeedbackForm.tsx
    "use client";

    import { zodResolver } from "@hookform/resolvers/zod";
    import React from "react";
    import { useForm } from "react-hook-form";
    import type { z } from "zod";

    import { Button } from "@/components/ui/button";
    import {
      Form,
      FormControl,
      FormField,
      FormItem,
      FormLabel,
      FormMessage,
    } from "@/components/ui/form";
    import { Input } from "@/components/ui/input";
    import { FeedbackFormSchema } from "@/types/schemas";
    import { sendFeedbackForm } from "@/actions/feedback";

    export function FeedbackForm() {
      const form = useForm<z.infer<typeof FeedbackFormSchema>>({
        resolver: zodResolver(FeedbackFormSchema),
        defaultValues: {
          email: "",
          content: "",
        },
      });

      async function onSubmit(values: z.infer<typeof FeedbackFormSchema>) {
        await sendFeedbackForm(values);
      }
      return (
        <div className="m-10 w-full rounded-md border p-5 sm:max-w-[425px]">
          <h1 className="text-lg font-semibold">Formularz</h1>
          <Form {...form}>
            <form
              onSubmit={form.handleSubmit(onSubmit)}
              className="grid w-full gap-4 py-4 sm:max-w-[425px]"
            >
              <FormField
                control={form.control}
                name="email"
                render={({ field }) => (
                  <FormItem>
                    <FormLabel>Opcja 1</FormLabel>
                    <FormControl>
                      <Input
                        placeholder="np. Bd zwizany z formularzem"
                        {...field}
                      />
                    </FormControl>
                    <FormMessage />
                  </FormItem>
                )}
              />
              <FormField
                control={form.control}
                name="content"
                render={({ field }) => (
                  <FormItem>
                    <FormLabel>Opcja 2</FormLabel>
                    <FormControl>
                      <Input
                        placeholder="np. Bd zwizany z formularzem"
                        {...field}
                      />
                    </FormControl>
                    <FormMessage />
                  </FormItem>
                )}
              />
              <Button type="submit">Przelij zgoszenie</Button>
            </form>
          </Form>
        </div>
      );
    }
    ```

</Steps>

## That's it

Na koniec mo偶esz do tego doda jakie adowanie, komunikaty o sukcesie, bdach, u偶y react-query, disable przycisk i pola w czasie wysylania itp. ale to ju偶 zale偶y od Ciebie. Teraz mo偶esz cieszy si swoim wasnym formularzem feedbacku, kt贸ry jest szybki i przyjemny dla u偶ytkownika.
