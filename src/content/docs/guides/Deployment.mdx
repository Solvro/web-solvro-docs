---
title: Deploy
description: Jak postawi apke na naszym serwerze na coolify?
---

import { Steps } from "@astrojs/starlight/components";

_Kr贸tki poradnik jak postawi apk Adonisow (i nie tylko) na Coolify korzystajc z GitHub App (autodeploy)_

## Repozytorium

Jeli macie gotowy projekt i repo na Solvrowskim GitHubie to mo偶ecie miao zdeploywa wasz apk.  
:::tip
Nawet jeli nie jest gotowy na produkcje, to mo偶ecie ju偶 go zdeployowa i np. ograniczy dostp [https://coolify.io/docs/knowledge-base/traefik/basic-auth/](https://coolify.io/docs/knowledge-base/traefik/basic-auth/)
:::

## Dockerfile (obligatoryjnie)

Coolify u偶ywa [Nixpacka](https://nixpacks.com/docs), kt贸ry na podstawie drzewa projektu jest w stanie wygenerowa obraz kontenera, kt贸ry bdzie chodzi potem na serwerze.

Niestety, Adonisa za pomoc nixpacka tak atwo nie postawicie, wic musicie stworzy dockerfilea - co nie jest zbyt skomplikowane.

Dockerfile najlepiej umieci w rootcie projektu o nazwie `Dockerfile` (tak domylnie Coolify szuka dockerfilea). Pamitajcie, 偶eby pushn dockerfilea do repo na GitHubie.

Link do dockerfilea z adonisowej dokumentacji, kt贸ry mo偶ecie dostosowa do swoich potrzeb:  
[https://docs.adonisjs.com/guides/getting-started/deployment\#creating-a-docker-image](https://docs.adonisjs.com/guides/getting-started/deployment#creating-a-docker-image)

## Coolify

Cr猫me de la cr猫me, dostpny pod adresem https://devops.solvro.pl - o dostpy do zarzdu

![](../../../assets/deployment/image8.png)

![](../../../assets/deployment/image11.png)

### Baza danych

W naszym przypadku u偶ywamy Postgresql, tu nie ma wikszej filozofii, wystarczy si przeklika i Coolify wszystko za nas ogarnie.

<Steps>

1. Klikamy `New` i tworzymy nowy resource

2. Wybieramy PostgresSQL

3. Wybieramy serwer

   - localhost - typowo produkcyjny serwer, dostpny pod adresami `*.solvro.pl`
   - Seohost - ma wicej ramu i wrzucamy tam mniej wa偶ne projekty albo projekty czonk贸w, dostpny pod adresami `*.s.solvro.pl`

4. Wybieramy domylnego Postgresa

5. Ewentualnie zmieniamy nazw na adniejsz

6. Mo偶na odpala 

</Steps>

![](../../../assets/deployment/image14.png)

Wa偶ne dane, kt贸re bd potrzebne do env贸w na backendzie:

- Username
- Password
- PostgresSQL URL (internal)

### Aplikacja

![](../../../assets/deployment/image4.png)

Jeli nie chcecie bawi si potem z autodeployem to wybierzcie Private Repository (with GitHub App) (nie sugerujcie si nazw, z public repo bdzie dziaa xd)

![](../../../assets/deployment/image12.png)

Wybieracie localhosta

![](../../../assets/deployment/image18.png)

Nie ma zbyt du偶ego wyboru xd Wybieracie solvro-coolify

![](../../../assets/deployment/image7.png)

Wybieracie swoje repo

![](../../../assets/deployment/image13.png)

W tym widoku domylnie jest wybrany Nixpacks, jeli wam to odpowiada, to zostawcie, a jak nie to wybierzcie Dockerfile (zawsze przy adonisie).

![](../../../assets/deployment/image2.png)

Uwa偶ka: po zmianach w zakadce zapisujcie zmiany, 偶eby potem nie wychodziy jakie kwiatki.

![](../../../assets/deployment/image17.png)

Widok po udanym utworzeniu resourca.  
Na pocztku warto zmieni nazw na bardziej czyteln, zmieni domen \{poddomena\}.solvro.pl, ewentualnie doda opis.  
Jeli macie monorepo to warto te偶 zmieni Base Directory, jeli macie np. w jednym repo frontend i backend.  
Przykad:

![](../../../assets/deployment/image3.png)
![](../../../assets/deployment/image5.png)

Dalej w zakadce General, Ports Exposes jest istotny, domylnie Adonis sucha na porcie 3333. Zakadka Pre/Post Deployment Commands jest u偶yteczna, jeli chcecie, 偶eby po ka偶dym deployu jaka akcja si wykonaa - w naszym przypadku wykonujemy migracje:

```sh
node ace migration:run --force
```

![](../../../assets/deployment/image20.png)

W advanceach warto zaznaczy Preview Deployments co pozwoli na sprawdzenie dziaania aplikacji po otworzeniu pull requestu na repo.

![](../../../assets/deployment/image9.png)
![](../../../assets/deployment/image19.png)

Kolejna wa偶na zakadka, Enviroment Variables - tu ustawiacie niezbdne zmienne rodowiskowe. Polecam wej w widok developerski, przeklei envy z folderu projektu adonisa i poustawia odpowiednie wartoci:

![](../../../assets/deployment/image16.png)

Dane do zmiennych zaczynajcych si od DB\_\{zmienna\} wycigacie z bazy kt贸r uprzednio utworzylicie, wszystkie dane mo偶ecie wycign z URLa bazy:

![](../../../assets/deployment/image15.png)

np. wklejajc do Gepetto albo Kloda

![](../../../assets/deployment/image6.png)

W Sourcie mozecie wybra brancha, kt贸rego chcecie deployowa.

![](../../../assets/deployment/image10.png)

Jeli nie chcecie mie irytujcego warningu koo statusu resourcea to mo偶ecie ustawi healthchecki ([https://coolify.io/docs/knowledge-base/health-checks/](https://coolify.io/docs/knowledge-base/health-checks/))

Po wicej szczeg贸贸w: [https://coolify.io/docs/](https://coolify.io/docs/)
